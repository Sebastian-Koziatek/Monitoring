# Status history – historia statusów

## Charakterystyka

**Status history** to wizualizacja przedstawiająca zmiany stanów w czasie w formie dyskretnych kolorowych boxów (kwadratów). Każdy box reprezentuje snapshot stanu w konkretnym momencie, pokazując kiedy wartość została zmierzona. Jest to idealne rozwiązanie do:

- Monitorowania statusów które zmieniają się często
- Wizualizacji discrete state changes z wyraźnymi timestamps
- Analizy health checks i availability
- Śledzenia zmian configuration states
- Identyfikacji flapping (częste zmiany między stanami)
- Porównywania stabilności wielu komponentów

**Kiedy używać Status history**:
- Stany zmieniają się często i chcesz zobaczyć każdą zmianę osobno
- Potrzebujesz zobaczyć dokładne timestamps zmian stanów
- Analizujesz flapping behavior (niestabilne przełączanie stanów)
- Monitoring high-frequency state changes
- Dane są sparse (rzadkie pomiary)

**Kiedy NIE używać Status history**:
- Stany zmieniają się rzadko i chcesz zobaczyć długość trwania - użyj State timeline
- Dane są continuous numerical - użyj Time series
- Potrzebujesz zobaczyć dokładne wartości liczbowe - użyj Table

**Różnica względem State timeline**:
- **Status history** - dyskretne boxy pokazujące punkty w czasie (lepsze dla częstych zmian, pokazuje każdy pomiar)
- **State timeline** - ciągłe paski pokazujące okresy trwania (lepsze dla rzadkich zmian, pokazuje jak długo stan trwał)

Analogia: Status history to jak "scatter plot" dla stanów, State timeline to jak "filled area chart" dla stanów.

---

## Konfiguracja Status History w Grafanie

### Krok 1: Wybór panelu
1. Przejdź do dashboardu Grafany.
2. Kliknij **Add a new panel**.
3. W sekcji "Visualization" wybierz **Status History**.

### Krok 2: Podłączenie źródła danych
- W sekcji **Query** podłącz odpowiednie źródło danych, np.:
  - Prometheus (`up` metrics)
  - InfluxDB
  - Elasticsearch

Przykład dla Prometheus:
```promql
up{job="my-service"}
```

## Konfiguracja

**Show values**: Auto | **Value mappings**: 1→Up, 0→Down | **Thresholds**: 0=Red, 1=Green

## Przykłady

**Flapping detection**: `up{job="api"}` - częste zmiany = flapping  
**Health checks**: `probe_success` - czerwone boxy = failed

## Best practices

Status history (pomiary częste, zobacz każdy) vs State timeline (stany długie, zobacz czas trwania)

## Troubleshooting

Liczby zamiast nazw: Dodaj Value mappings | Za dużo boxów: Użyj State timeline

3. **Legend:**
   - Dodaj opisy do statusów dla większej czytelności.

---

## Przykład użycia Status History
- **Scenariusz:** Monitorowanie statusu aplikacji „My-App”.
- **Dane:**
   - Status aplikacji zbierany z Prometheusa.
   - Metric: `up{job="my-app"}`.

### Efekt:
Paski statusów wizualnie prezentują:
- **Zielony:** Usługa była **UP**.
- **Czerwony:** Usługa była **DOWN**.

Grafana pokaże, kiedy i na jak długo usługa była w stanie „DOWN”.

---

## Zalety Status History
- **Intuicyjna wizualizacja** zmian statusów.
- **Szybka identyfikacja problemów** w systemie.
- **Czytelność danych historycznych.**
- Wsparcie dla różnorodnych źródeł danych.

---

## Podsumowanie
Wizualizacja **Status History** to potężne narzędzie Grafany, które pozwala na efektywną analizę zmian statusów w czasie. Dzięki niej łatwo zidentyfikować, kiedy występowały problemy oraz jak długo trwały, co jest niezwykle istotne przy monitorowaniu systemów produkcyjnych i analizie incydentów.
