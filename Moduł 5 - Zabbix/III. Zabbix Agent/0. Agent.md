# Agent Zabbix - Wprowadzenie i przegląd

<h2 align="center">Wprowadzenie</h2>

Agent Zabbix to lekka aplikacja kliencka, która jest instalowana na monitorowanych hostach w celu aktywnego zbierania danych lokalnych i przesyłania ich do serwera Zabbix. Agent umożliwia monitorowanie zasobów systemowych, aplikacji i usług bezpośrednio z poziomu systemu operacyjnego.

**Główne funkcje agenta:**
- Zbieranie metryk systemowych (CPU, pamięć, dysk, sieć)
- Monitorowanie procesów i usług
- Wykonywanie niestandardowych sprawdzeń przez skrypty
- Przesyłanie logów do serwera Zabbix
- Umożliwienie zdalnego wykonywania poleceń (funkcja opcjonalna)

---

<h2 align="center">Agent vs Agent2 - Kluczowe różnice</h2>

<table align="center">
<thead>
<tr>
<th align="center"><strong>Cecha</strong></th>
<th align="center"><strong>Zabbix Agent (klasyczny)</strong></th>
<th align="center"><strong>Zabbix Agent2</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>Język programowania</strong></td>
<td align="center">C</td>
<td align="center">Go</td>
</tr>
<tr>
<td align="center"><strong>Architektura</strong></td>
<td align="center">Jednowątkowa</td>
<td align="center">Wielowątkowa</td>
</tr>
<tr>
<td align="center"><strong>Wydajność</strong></td>
<td align="center">Do 100 sprawdzeń/sekundę</td>
<td align="center">Ponad 1000 sprawdzeń/sekundę</td>
</tr>
<tr>
<td align="center"><strong>Zużycie pamięci</strong></td>
<td align="center">2-10 MB</td>
<td align="center">10-50 MB</td>
</tr>
<tr>
<td align="center"><strong>Zużycie CPU</strong></td>
<td align="center">Niskie</td>
<td align="center">Średnie</td>
</tr>
<tr>
<td align="center"><strong>Obsługa wtyczek</strong></td>
<td align="center">Brak</td>
<td align="center">Wbudowane i niestandardowe</td>
</tr>
<tr>
<td align="center"><strong>Wsparcie TLS</strong></td>
<td align="center">Podstawowe</td>
<td align="center">Zaawansowane</td>
</tr>
<tr>
<td align="center"><strong>Sprawdzenia HTTP</strong></td>
<td align="center">Przez zewnętrzne narzędzia</td>
<td align="center">Wbudowane</td>
</tr>
<tr>
<td align="center"><strong>Minimalna wersja Zabbix</strong></td>
<td align="center">Wszystkie</td>
<td align="center">5.0+</td>
</tr>
<tr>
<td align="center"><strong>Stabilność</strong></td>
<td align="center">Bardzo wysoka</td>
<td align="center">Wysoka</td>
</tr>
<tr>
<td align="center"><strong>Łatwość konfiguracji</strong></td>
<td align="center">Bardzo prosta</td>
<td align="center">Prosta</td>
</tr>
<tr>
<td align="center"><strong>Wsparcie kontenerów</strong></td>
<td align="center">Ograniczone</td>
<td align="center">Pełne</td>
</tr>
<tr>
<td align="center"><strong>Monitorowanie baz danych</strong></td>
<td align="center">Zewnętrzne skrypty</td>
<td align="center">Wbudowane wtyczki</td>
</tr>
<tr>
<td align="center"><strong>Plik konfiguracyjny</strong></td>
<td align="center"><code>/etc/zabbix/zabbix_agentd.conf</code></td>
<td align="center"><code>/etc/zabbix/zabbix_agent2.conf</code></td>
</tr>
<tr>
<td align="center"><strong>Nazwa pakietu</strong></td>
<td align="center"><code>zabbix-agent</code></td>
<td align="center"><code>zabbix-agent2</code></td>
</tr>
<tr>
<td align="center"><strong>Port domyślny</strong></td>
<td align="center">10050</td>
<td align="center">10050</td>
</tr>
</tbody>
</table>

### Zalety Zabbix Agent (klasyczny)
- Wysoka stabilność i niezawodność
- Niskie zużycie zasobów systemowych
- Pełna kompatybilność z wcześniejszymi wersjami Zabbix
- Dobrze przetestowany w środowiskach produkcyjnych
- Prosty w konfiguracji i zarządzaniu

### Zalety Zabbix Agent2
- Znacznie wyższa wydajność w porównaniu z klasycznym agentem
- Wbudowane wtyczki dla popularnych systemów (MongoDB, MySQL, PostgreSQL, Docker)
- Obsługa sprawdzeń HTTP/HTTPS bez dodatkowych narzędzi
- Lepsze zarządzanie pamięcią i zasobami
- Możliwość równoległego przetwarzania zapytań
- Zaawansowana obsługa protokołu TLS

---

<h2 align="center">Aktywny i pasywny tryb agenta</h2>

Zabbix Agent może działać w dwóch różnych trybach komunikacji z serwerem Zabbix, z których każdy ma swoje unikalne charakterystyki i zastosowania.

<table align="center">
<thead>
<tr>
<th align="center"><strong>Aspekt</strong></th>
<th align="center"><strong>Tryb Pasywny</strong></th>
<th align="center"><strong>Tryb Aktywny</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>Inicjowanie połączenia</strong></td>
<td align="center">Serwer → Agent</td>
<td align="center">Agent → Serwer</td>
</tr>
<tr>
<td align="center"><strong>Port komunikacyjny</strong></td>
<td align="center">10050 (agent nasłuchuje)</td>
<td align="center">10051 (serwer nasłuchuje)</td>
</tr>
<tr>
<td align="center"><strong>Konfiguracja firewall</strong></td>
<td align="center">Otwórz port 10050 na agencie</td>
<td align="center">Otwórz port 10051 na serwerze</td>
</tr>
<tr>
<td align="center"><strong>Obciążenie serwera</strong></td>
<td align="center">Wyższe (serwer odpytuje)</td>
<td align="center">Niższe (agent przesyła dane)</td>
</tr>
<tr>
<td align="center"><strong>Obciążenie sieci</strong></td>
<td align="center">Średnie</td>
<td align="center">Niższe</td>
</tr>
<tr>
<td align="center"><strong>Skalowalność</strong></td>
<td align="center">Ograniczona</td>
<td align="center">Wysoka</td>
</tr>
<tr>
<td align="center"><strong>Rozwiązywanie problemów</strong></td>
<td align="center">Łatwiejsze</td>
<td align="center">Bardziej złożone</td>
</tr>
<tr>
<td align="center"><strong>Opóźnienie danych</strong></td>
<td align="center">Zależne od interwału odpytywania</td>
<td align="center">Minimalne</td>
</tr>
<tr>
<td align="center"><strong>Praca offline</strong></td>
<td align="center">Brak buforowania</td>
<td align="center">Lokalne buforowanie</td>
</tr>
<tr>
<td align="center"><strong>Elastyczność konfiguracji</strong></td>
<td align="center">Ograniczona</td>
<td align="center">Wysoka</td>
</tr>
<tr>
<td align="center"><strong>Zalecane zastosowanie</strong></td>
<td align="center">Małe środowiska, testowanie</td>
<td align="center">Duże środowiska, produkcja</td>
</tr>
</tbody>
</table>

### Tryb Pasywny
**Charakterystyka:**
- Serwer Zabbix inicjuje połączenie z agentem
- Agent nasłuchuje na porcie 10050 i odpowiada na żądania
- Serwer regularnie odpytuje agenta o dane
- Prostszy w konfiguracji i diagnozowaniu problemów

**Zalety:**
- Łatwość konfiguracji i zarządzania
- Prostsze rozwiązywanie problemów sieciowych
- Natychmiastowe sprawdzenie dostępności agenta
- Idealny dla środowisk testowych i małych instalacji

**Wady:**
- Większe obciążenie serwera przy dużej liczbie agentów
- Wymaga otwartego portu 10050 na każdym agencie
- Ograniczona skalowalność
- Brak buforowania danych przy problemach łączności

### Tryb Aktywny
**Charakterystyka:**
- Agent inicjuje połączenie z serwerem
- Agent aktywnie przesyła dane do serwera na port 10051
- Agent pobiera listę sprawdzeń z serwera i wykonuje je lokalnie
- Bardziej wydajny dla dużych środowisk

**Zalety:**
- Znacznie lepsza skalowalność
- Niższe obciążenie serwera
- Lokalne buforowanie danych
- Tylko jeden port (10051) do otwarcia na serwerze
- Idealny dla dużych środowisk produkcyjnych

**Wady:**
- Bardziej złożona konfiguracja
- Trudniejsze diagnozowanie problemów łączności
- Opóźnienie w wykrywaniu problemów z agentem
- Wymaga dodatkowej konfiguracji w środowiskach z NAT

### Konfiguracja trybu w pliku agenta

**Tryb Pasywny:**
```bash
# /etc/zabbix/zabbix_agentd.conf
Server=192.168.1.100
ServerActive=
StartAgents=3
```

**Tryb Aktywny:**
```bash
# /etc/zabbix/zabbix_agentd.conf
Server=
ServerActive=192.168.1.100:10051
StartAgents=0
Hostname=agent-hostname
```

**Tryb Mieszany (oba tryby jednocześnie):**
```bash
# /etc/zabbix/zabbix_agentd.conf
Server=192.168.1.100
ServerActive=192.168.1.100:10051
StartAgents=3
Hostname=agent-hostname
```

---

<h2 align="center">Wytyczne wyboru odpowiedniego agenta</h2>

### Kiedy wybrać Zabbix Agent (wersja klasyczna)

Klasyczny agent jest właściwym wyborem w następujących sytuacjach:
- Środowisko oparte na starszych wersjach Zabbix (poniżej 5.0)
- Systemy o ograniczonych zasobach sprzętowych
- Proste wymagania monitoringowe bez potrzeby zaawansowanych funkcji
- Środowiska, gdzie stabilność jest priorytetem nad wydajnością
- Starsze systemy operacyjne z ograniczoną kompatybilnością

### Kiedy wybrać Zabbix Agent2

Agent2 jest zalecany w następujących scenariuszach:
- Potrzeba wysokiej wydajności monitoringu
- Monitorowanie baz danych (MySQL, PostgreSQL, MongoDB)
- Wykorzystanie wbudowanych wtyczek dla różnych systemów
- Zaawansowane sprawdzenia HTTP/HTTPS
- Nowoczesne środowisko z Zabbix w wersji 5.0 lub nowszej
- Intensywne monitorowanie aplikacji i kontenerów

---

## Dostępne wtyczki w Agent2

Agent2 oferuje szeroki zestaw wbudowanych wtyczek, które znacznie rozszerzają możliwości monitoringu:

**Wtyczki dla baz danych:**
- **MySQL** - kompleksowe monitorowanie baz danych MySQL i MariaDB
- **PostgreSQL** - monitorowanie wydajności i stanu baz PostgreSQL
- **MongoDB** - sprawdzanie parametrów baz dokumentowych MongoDB
- **Redis** - monitorowanie systemów cache Redis

**Wtyczki dla systemów:**
- **Docker** - monitorowanie kontenerów i obrazów Docker
- **Systemd** - sprawdzanie stanu usług systemowych
- **SMART** - monitorowanie kondycji dysków twardych

**Wtyczki sieciowe:**
- **HTTP Agent** - wykonywanie sprawdzeń HTTP/HTTPS
- **Memcached** - monitorowanie systemów cache Memcached

---

## Bezpieczeństwo i szyfrowanie

### Agent klasyczny
- Obsługa PSK (Pre-Shared Key) dla uwierzytelniania
- Podstawowe szyfrowanie TLS
- Kontrola dostępu oparta na adresach IP
- Standardowe mechanizmy bezpieczeństwa

### Agent2
- Zaawansowane szyfrowanie TLS w wersji 1.3
- Ulepszone zarządzanie certyfikatami
- Wbudowane mechanizmy bezpieczeństwa na poziomie aplikacji
- Obsługa nowoczesnych algorytmów kryptograficznych
- Lepsza izolacja procesów i zarządzanie uprawnieniami

---

<h2 align="center">Wytyczne wyboru odpowiedniego agenta</h2>

### Kiedy wybrać Zabbix Agent (wersja klasyczna)

- **Starsze wersje Zabbix** (przed 5.0)
- **Środowiska o ograniczonych zasobach** systemowych
- **Proste scenariusze monitoringu** bez potrzeby zaawansowanych funkcji
- **Stabilne środowiska produkcyjne** gdzie zmiana może wprowadzić ryzyko

### Kiedy wybrać Zabbix Agent2

- **Nowe instalacje** z Zabbix 5.0 lub nowszym
- **Środowiska wymagające wysokiej wydajności** i skalowania
- **Integracja z nowoczesnymi technologiami** (kontenery, chmura)
- **Potrzeba zaawansowanych funkcji** monitoringu i automatyzacji

---

<h2 align="center">Podsumowanie</h2>

Wybór między klasycznym agentem Zabbix a Agent2 powinien być oparty na dokładnej analizie wymagań środowiska oraz planach rozwoju infrastruktury monitoringu.

**Agent2 reprezentuje przyszłość** platformy Zabbix, oferując znacznie wyższą wydajność, rozszerzoną funkcjonalność oraz lepsze możliwości integracji z nowoczesnymi systemami. Jednak wymaga więcej zasobów systemowych i dostępny jest tylko w nowszych wersjach Zabbix.

**Klasyczny agent pozostaje doskonałym wyborem** dla środowisk o ograniczonych zasobach, starszych instalacji Zabbix oraz sytuacji, gdzie stabilność i prostota są priorytetem nad zaawansowaną funkcjonalnością.

**Zalecenie dla nowych wdrożeń:** W przypadku implementacji nowych systemów monitoringu z wykorzystaniem Zabbix 5.0 lub nowszego, zaleca się wybór Agent2. Dla istniejących środowisk decyzja o migracji powinna być poprzedzona szczegółową analizą korzyści i kosztów oraz testami w środowisku nieprodukyjnym.