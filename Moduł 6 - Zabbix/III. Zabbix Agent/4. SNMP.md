<h3 align="center">Jak Zabbix pobiera metryki przez SNMP?</h3>

Wszystkie powyższe wpisy pozwalają serwerowi Zabbix pobierać konkretne metryki przez SNMP. Jednak większość typowych parametrów systemowych (pamięć RAM, CPU, interfejsy sieciowe, dyski, uptime itd.) jest dostępna domyślnie przez standardowe OID-y SNMP, które są obsługiwane automatycznie przez agenta snmpd.

**Przykład:**
- Jeśli używasz template „SNMP by Linux server” w Zabbix, to odczyt takich danych jak RAM, CPU, sieć, dyski odbywa się przez standardowe OID-y SNMP, bez konieczności ręcznego konfigurowania tych wpisów w snmpd.conf.
- Wpisy typu <code>proc</code>, <code>disk</code>, <code>load</code>, <code>extend</code> pozwalają na monitorowanie dodatkowych, niestandardowych parametrów, które nie są dostępne w standardzie SNMP.

**Podsumowanie:**
- Wpisy w pliku konfiguracyjnym snmpd.conf określają dodatkowe monitorowane elementy, ale większość typowych metryk (RAM, CPU, sieć) jest dostępna domyślnie przez SNMP i może być pobierana przez Zabbix z odpowiedniego template.

---
<h3 align="center">Instalacja SNMP</h3>
Zainstaluj i skonfiguruj usługę SNMP:

```bash
sudo apt update
sudo apt install snmp snmpd
sudo nano /etc/snmp/snmpd.conf
```

Przykładowa konfiguracja (SNMP v2c):
```bash
rocommunity public  default    -V systemonly
agentAddress udp:161,udp6:161
```

**Opis wpisów:**

- `rocommunity public  default    -V systemonly`  
	Definiuje community string (hasło dostępu) dla odczytu (read-only). W tym przypadku `public` pozwala na odczyt danych SNMP z dowolnego hosta (`default`). Opcja `-V systemonly` ogranicza dostęp tylko do podstawowych informacji systemowych.

- `agentAddress udp:161,udp6:161`  
	Określa adresy i porty, na których SNMP nasłuchuje. `udp:161` oznacza nasłuchiwanie na porcie 161 dla IPv4, a `udp6:161` dla IPv6.

Uruchom usługę SNMP:
```bash
sudo systemctl restart snmpd
sudo systemctl enable snmpd
```

Sprawdź działanie:
```bash
snmpwalk -v2c -c public localhost
```

---

## 3. Dodanie hosta SNMP w Zabbix

1. Przejdź do panelu Zabbix → Configuration → Hosts → Create host
2. Wprowadź nazwę hosta i grupę
3. W sekcji "Interfaces" dodaj interfejs typu SNMP, podając adres IP urządzenia
4. Wybierz odpowiedni template, np. `Template SNMP Generic` lub dedykowany dla danego producenta
5. W sekcji "Macros" dodaj makro:
	 - `{SNMP_COMMUNITY}` – wpisz community string (np. `public`)

---

## 4. Testowanie i weryfikacja

- Sprawdź status połączenia w Zabbix (Monitoring → Latest data)
- Upewnij się, że dane są pobierane z urządzenia SNMP
- W razie problemów sprawdź logi Zabbix oraz SNMP na urządzeniu

---

## 5. Dobre praktyki

- Używaj dedykowanych community stringów zamiast domyślnego `public`
- Ogranicz dostęp do SNMP tylko z zaufanych adresów IP
- Rozważ użycie SNMPv3 dla lepszego bezpieczeństwa (autoryzacja i szyfrowanie)
- Regularnie aktualizuj firmware urządzeń sieciowych

---

## 6. Przykładowa konfiguracja SNMPv3 (Linux)

W pliku `/etc/snmp/snmpd.conf`:
```
createUser monitoring SHA "haslo123" AES "klucz123"
rouser monitoring
```

Restart usługi:
```bash
sudo systemctl restart snmpd
```

W Zabbix w interfejsie SNMP wybierz wersję v3 i podaj login/hasło.

---

<h2 align="center">Wyjaśnienie najważniejszych wpisów w pliku konfiguracyjnym SNMP (snmpd.conf)</h2>

Poniżej znajdziesz omówienie najczęściej spotykanych wpisów w pliku konfiguracyjnym SNMP, które pozwalają rozszerzyć monitoring systemu przez Zabbix:

<table>
	<thead>
		<tr>
			<th>Wpis konfiguracyjny</th>
			<th>Opis działania</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><code>master agentx</code></td>
			<td>Pozwala SNMP na współpracę z innymi agentami (np. subagentami). Umożliwia integrację z dodatkowymi źródłami danych.</td>
		</tr>
		<tr>
			<td><code>proc sshd 1 5</code></td>
			<td>Monitoruje proces sshd. Ostrzeżenie, jeśli jest mniej niż 1 lub więcej niż 5 procesów.</td>
		</tr>
		<tr>
			<td><code>proc snmpd 1 1</code></td>
			<td>Monitoruje proces snmpd. Ostrzeżenie, jeśli nie działa dokładnie 1 proces.</td>
		</tr>
		<tr>
			<td><code>disk / 90%</code></td>
			<td>Monitoruje zapełnienie dysku głównego (/). Ostrzeżenie przy przekroczeniu 90%.</td>
		</tr>
		<tr>
			<td><code>load 5 10 15</code></td>
			<td>Monitoruje obciążenie systemu (load average) dla 1, 5 i 15 minut. Ostrzeżenia przy wartościach powyżej 5, 10, 15.</td>
		</tr>
		<tr>
			<td><code>extend test1 /bin/echo "SNMP działa poprawnie"</code></td>
			<td>Dodaje własną metrykę SNMP, która zwraca tekst „SNMP działa poprawnie”. Pozwala na tworzenie niestandardowych sprawdzeń dostępnych przez SNMP.</td>
		</tr>
		<tr>
			<td><code>sysServices 72</code></td>
			<td>Informuje, jakie usługi systemowe są dostępne (kod 72 oznacza typowe usługi dla serwera).</td>
		</tr>
	</tbody>
</table>

---

<h2 align="center">Podsumowanie</h2>

Monitoring SNMP w Zabbix pozwala na zbieranie danych z urządzeń sieciowych i serwerów bez instalacji agenta. Konfiguracja sprowadza się do poprawnego ustawienia SNMP na urządzeniu oraz odpowiedniego dodania hosta w Zabbix.

## 1. Wymagania wstępne

### Przykład: Linux (net-snmp)

Zainstaluj i skonfiguruj usługę SNMP:
```bash
sudo apt update
sudo apt install snmp snmpd
sudo nano /etc/snmp/snmpd.conf
```


Przykładowa konfiguracja (SNMP v2c):
```bash
rocommunity public  default    -V systemonly
agentAddress udp:161,udp6:161
```

**Opis wpisów:**

- `rocommunity public  default    -V systemonly`  
	Definiuje community string (hasło dostępu) dla odczytu (read-only). W tym przypadku `public` pozwala na odczyt danych SNMP z dowolnego hosta (`default`). Opcja `-V systemonly` ogranicza dostęp tylko do podstawowych informacji systemowych.

- `agentAddress udp:161,udp6:161`  
	Określa adresy i porty, na których SNMP nasłuchuje. `udp:161` oznacza nasłuchiwanie na porcie 161 dla IPv4, a `udp6:161` dla IPv6.

Uruchom usługę SNMP:
```bash
sudo systemctl restart snmpd
sudo systemctl enable snmpd
```

Sprawdź działanie:
```bash
snmpwalk -v2c -c public localhost
```

---

## 3. Dodanie hosta SNMP w Zabbix

1. Przejdź do panelu Zabbix → Configuration → Hosts → Create host
2. Wprowadź nazwę hosta i grupę
3. W sekcji "Interfaces" dodaj interfejs typu SNMP, podając adres IP urządzenia
4. Wybierz odpowiedni template, np. `Template SNMP Generic` lub dedykowany dla danego producenta
5. W sekcji "Macros" dodaj makro:
	- `{SNMP_COMMUNITY}` – wpisz community string (np. `public`)

---

## 4. Testowanie i weryfikacja

- Sprawdź status połączenia w Zabbix (Monitoring → Latest data)
- Upewnij się, że dane są pobierane z urządzenia SNMP
- W razie problemów sprawdź logi Zabbix oraz SNMP na urządzeniu

---

## 5. Dobre praktyki

- Używaj dedykowanych community stringów zamiast domyślnego `public`
- Ogranicz dostęp do SNMP tylko z zaufanych adresów IP
- Rozważ użycie SNMPv3 dla lepszego bezpieczeństwa (autoryzacja i szyfrowanie)
- Regularnie aktualizuj firmware urządzeń sieciowych

---

## 6. Przykładowa konfiguracja SNMPv3 (Linux)

W pliku `/etc/snmp/snmpd.conf`:
```
createUser monitoring SHA "haslo123" AES "klucz123"
rouser monitoring
```

Restart usługi:
```bash
sudo systemctl restart snmpd
```

W Zabbix w interfejsie SNMP wybierz wersję v3 i podaj login/hasło.

---

<h2 align="center">Podsumowanie</h2>

Monitoring SNMP w Zabbix pozwala na zbieranie danych z urządzeń sieciowych i serwerów bez instalacji agenta. Konfiguracja sprowadza się do poprawnego ustawienia SNMP na urządzeniu oraz odpowiedniego dodania hosta w Zabbix.

---

<h2 align="center">Wyjaśnienie najważniejszych wpisów w pliku konfiguracyjnym SNMP (snmpd.conf)</h2>

Poniżej znajdziesz omówienie najczęściej spotykanych wpisów w pliku konfiguracyjnym SNMP, które pozwalają rozszerzyć monitoring systemu przez Zabbix:

<table>
	<thead>
		<tr>
			<th>Wpis konfiguracyjny</th>
			<th>Opis działania</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><code>master agentx</code></td>
			<td>Pozwala SNMP na współpracę z innymi agentami (np. subagentami). Umożliwia integrację z dodatkowymi źródłami danych.</td>
		</tr>
		<tr>
			<td><code>proc sshd 1 5</code></td>
			<td>Monitoruje proces sshd. Ostrzeżenie, jeśli jest mniej niż 1 lub więcej niż 5 procesów.</td>
		</tr>
		<tr>
			<td><code>proc snmpd 1 1</code></td>
			<td>Monitoruje proces snmpd. Ostrzeżenie, jeśli nie działa dokładnie 1 proces.</td>
		</tr>
		<tr>
			<td><code>disk / 90%</code></td>
			<td>Monitoruje zapełnienie dysku głównego (/). Ostrzeżenie przy przekroczeniu 90%.</td>
		</tr>
		<tr>
			<td><code>load 5 10 15</code></td>
			<td>Monitoruje obciążenie systemu (load average) dla 1, 5 i 15 minut. Ostrzeżenia przy wartościach powyżej 5, 10, 15.</td>
		</tr>
		<tr>
			<td><code>extend test1 /bin/echo "SNMP działa poprawnie"</code></td>
			<td>Dodaje własną metrykę SNMP, która zwraca tekst „SNMP działa poprawnie”. Pozwala na tworzenie niestandardowych sprawdzeń dostępnych przez SNMP.</td>
		</tr>
		<tr>
			<td><code>sysServices 72</code></td>
			<td>Informuje, jakie usługi systemowe są dostępne (kod 72 oznacza typowe usługi dla serwera).</td>
		</tr>
	</tbody>
</table>

---

<h3 align="center">Jak Zabbix pobiera metryki przez SNMP?</h3>

Wszystkie powyższe wpisy pozwalają serwerowi Zabbix pobierać konkretne metryki przez SNMP. Jednak większość typowych parametrów systemowych (pamięć RAM, CPU, interfejsy sieciowe, dyski, uptime itd.) jest dostępna domyślnie przez standardowe OID-y SNMP, które są obsługiwane automatycznie przez agenta snmpd.

**Przykład:**
- Jeśli używasz template „SNMP by Linux server” w Zabbix, to odczyt takich danych jak RAM, CPU, sieć, dyski odbywa się przez standardowe OID-y SNMP, bez konieczności ręcznego konfigurowania tych wpisów w snmpd.conf.
- Wpisy typu <code>proc</code>, <code>disk</code>, <code>load</code>, <code>extend</code> pozwalają na monitorowanie dodatkowych, niestandardowych parametrów, które nie są dostępne w standardzie SNMP.

**Podsumowanie:**
- Wpisy w pliku konfiguracyjnym snmpd.conf określają dodatkowe monitorowane elementy, ale większość typowych metryk (RAM, CPU, sieć) jest dostępna domyślnie przez SNMP i może być pobierana przez Zabbix z odpowiedniego template.
